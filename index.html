<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Futanium Box 3.0</title>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400" rel="stylesheet"/>

<style>
  :root {
    --header:#151823; --bg:#F3F3F3; --card:#FFFFFF; --muted:#9EA3AF; --ink:#0B0F1A;
    --shadow:0 2px 8px rgba(0,0,0,.10);
  }
  *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent }
  html,body{ margin:0; padding:0; height:100%; background:var(--bg); font:15px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  body { overflow:hidden; }

  .app { display:flex; flex-direction:column; height:100vh; }

  .top {
    position:sticky; top:0; z-index:1000;
    display:flex; align-items:center; justify-content:space-between;
    height:60px; padding:0 12px;
    background:var(--header); color:#fff;
    box-shadow:0 2px 10px rgba(0,0,0,.35);
  }
  .brand{ font-weight:700; font-size:18px }
  .iconBtn{ width:46px; height:46px; border:0; background:transparent; color:#fff;
    display:inline-grid; place-items:center; border-radius:50%; cursor:pointer; }

  .chipWrap {
    position:sticky; top:60px; z-index:900;
    text-align:center; padding:8px 0; background:var(--bg);
  }
  .chip {
    display:inline-block; padding:6px 14px; border-radius:12px;
    background:#fff; color:#555; font-weight:700;
    box-shadow:0 3px 8px rgba(0,0,0,.15);
  }

  /* Player fixo */
  .playerWrap {
    position:sticky; top:112px; z-index:800;
    background:#000; width:100%; max-width:100%;
    aspect-ratio:16/9; border-radius:14px; overflow:hidden;
    margin:0 auto;
  }
  #playerFrame {
    width:100%; height:100%; border:0;
  }
  .fullscreenBtn {
    position:absolute; top:10px; right:10px;
    background:rgba(0,0,0,.6); color:#fff;
    padding:6px 12px; border-radius:8px;
    font-size:14px; cursor:pointer;
  }

  /* Mensagem inicial */
  .placeholderMsg {
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    color:#fff; text-align:center; font-size:18px; padding:10px;
  }

  /* Lista scroll√°vel */
  .list {
    flex:1; overflow-y:auto; -webkit-overflow-scrolling:touch;
    padding:16px 12px; margin-top:16px;
  }
  .card {
    background:var(--card); border-radius:14px;
    padding:12px; margin-bottom:12px; box-shadow:var(--shadow);
  }
  .champ{ display:flex; align-items:center; gap:8px; color:var(--muted); font-weight:600; margin-bottom:8px }
  .clogo{ width:24px; height:24px; object-fit:contain }
  .row{ display:flex; align-items:center; justify-content:space-between; gap:8px }
  .team{ width:150px; text-align:center }
  .tlogo{ width:50px; height:50px; object-fit:contain }
  .tname{ margin-top:6px; font-size:12px; min-height:32px }
  .timeBox{ height:50px; display:flex; flex-direction:column; align-items:center; justify-content:center }
  .ttxt{ font-size:20px; font-weight:700; color:#000 }

  .btns {
    margin:12px 0 20px 0;
    display:flex; flex-wrap:wrap; gap:10px;
  }
  .btn {
    background:#E0E0E0; padding:10px 18px; border-radius:10px;
    font-weight:600; cursor:pointer; text-decoration:none;
    color:#000; font-size:15px;
  }
</style>
</head>
<body>
<div class="app">
  <div class="top">
    <div class="brand">Futanium Web</div>
    <button id="btnRefresh" class="iconBtn"><span class="mi">autorenew</span></button>
  </div>

  <div class="chipWrap"><div class="chip" id="todayChip">JOGOS DE HOJE</div></div>

  <div class="playerWrap" id="playerWrap">
    <iframe id="playerFrame" allow="autoplay" allowfullscreen></iframe>
    <div class="placeholderMsg" id="placeholderMsg">Escolha um jogo para assistir</div>
    <div class="fullscreenBtn" onclick="goFullscreen()">Tela cheia</div>
  </div>

  <div class="btns" id="channelButtons" style="display:none;"></div>

  <div class="list" id="list"></div>
</div>

<script type="module">
const API_HTTP = "https://futaniumwebapp.vercel.app/api/games";
const todayChip = document.getElementById("todayChip");
todayChip.textContent = "JOGOS DE HOJE " + new Date().toLocaleDateString("pt-BR",{day:'2-digit',month:'2-digit'});

const playerFrame = document.getElementById("playerFrame");
const placeholderMsg = document.getElementById("placeholderMsg");
const channelButtons = document.getElementById("channelButtons");
const listEl = document.getElementById("list");

async function load() {
  const res = await fetch(API_HTTP, { cache: 'no-store' });
  const data = await res.json();
  renderList(data);
}
function renderList(items){
  listEl.innerHTML='';
  items.forEach(it=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <div class="champ">
        <img class="clogo" src="${it.championship_image_url||''}">
        <div>${it.championship||''}</div>
      </div>
      <div class="row">
        <div class="team"><img class="tlogo" src="${it.home_team_image_url||''}"><div class="tname">${it.home_team||''}</div></div>
        <div class="timeBox"><div class="ttxt">${it.start_time||''}</div></div>
        <div class="team"><img class="tlogo" src="${it.visiting_team_image_url||''}"><div class="tname">${it.visiting_team||''}</div></div>
      </div>`;
    card.onclick=()=>{
      placeholderMsg.innerHTML=`<div>Escolha um canal para assistir:<br>${it.home_team} x ${it.visiting_team}</div>`;
      channelButtons.innerHTML='';
      if(Array.isArray(it.buttons)&&it.buttons.length>0){
        channelButtons.style.display='flex';
        it.buttons.forEach((b)=>{
          const btn=document.createElement('button');
          btn.className='btn';
          btn.textContent=b.name;
          btn.onclick=()=>{
            playerFrame.src=b.url + (b.url.includes('?') ? '&autoplay=1&muted=0' : '?autoplay=1&muted=0');
            placeholderMsg.style.display='none';
          };
          channelButtons.appendChild(btn);
        });
      } else {
        channelButtons.style.display='none';
      }
    };
    listEl.appendChild(card);
  });
}
function goFullscreen(){
  const frame = playerFrame;
  if(frame.requestFullscreen) frame.requestFullscreen();
  else if(frame.webkitRequestFullscreen) frame.webkitRequestFullscreen();
  else if(frame.msRequestFullscreen) frame.msRequestFullscreen();
}

load();
</script>
</body>
</html>